"use strict";(()=>{var e={};e.id=312,e.ids=[312],e.modules={3480:(e,r,o)=>{e.exports=o(5600)},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6435:(e,r)=>{Object.defineProperty(r,"M",{enumerable:!0,get:function(){return function e(r,o){return o in r?r[o]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,o)):"function"==typeof r&&"default"===o?r:void 0}}})},8667:(e,r)=>{Object.defineProperty(r,"A",{enumerable:!0,get:function(){return o}});var o=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},9914:(e,r,o)=>{o.r(r),o.d(r,{config:()=>l,default:()=>p,routeModule:()=>c});var t={};o.r(t),o.d(t,{default:()=>s});var a=o(3480),n=o(8667),i=o(6435);async function s(e,r){let{criteria:o}=e.body;if(!o)return r.status(400).json({message:"Criteria is required"});let t={"52 week High":"52-week-high","Volume Buzzers":"volume-buzzers","1 Month High":"1-month-high","100% up in a Year":"100-percent-up"};try{let e=(e=>{let r={"52-week-high":{columns:["name","description","close","change","volume","relative_volume","SMA20","market_cap_basic","sector"],filter:[{left:"country",operation:"in_range",right:["India"]},{left:"close",operation:"egreater",right:30},{left:"exchange",operation:"in_range",right:["NSE"]},{left:"average_volume_60d_calc",operation:"greater",right:1e5},{left:"price_52_week_high",operation:"eless",right:"high"},{left:"market_cap_basic",operation:"egreater",right:8e9},{left:"is_primary",operation:"equal",right:!0}],ignore_unknown_fields:!1,options:{lang:"en"},range:[0,100],sort:{sortBy:"market_cap_basic",sortOrder:"desc"},symbols:{},markets:["india"],filter2:{operator:"and",operands:[{operation:{operator:"or",operands:[{operation:{operator:"and",operands:[{expression:{left:"type",operation:"equal",right:"stock"}},{expression:{left:"typespecs",operation:"has",right:["common"]}}]}}]}},{operation:{operator:"or",operands:[{operation:{operator:"and",operands:[{expression:{left:"type",operation:"equal",right:"stock"}},{expression:{left:"typespecs",operation:"has",right:["common"]}}]}},{operation:{operator:"and",operands:[{expression:{left:"type",operation:"equal",right:"stock"}},{expression:{left:"typespecs",operation:"has",right:["preferred"]}}]}},{operation:{operator:"and",operands:[{expression:{left:"type",operation:"equal",right:"dr"}}]}},{operation:{operator:"and",operands:[{expression:{left:"type",operation:"equal",right:"fund"}},{expression:{left:"typespecs",operation:"has_none_of",right:["etf"]}}]}}]}}]}},"volume-buzzers":{columns:["name","description","close","change","volume","relative_volume","SMA20","market_cap_basic","sector"],filter:[{left:"close",operation:"egreater",right:30},{left:"country",operation:"in_range",right:["India"]},{left:"exchange",operation:"in_range",right:["NSE"]},{left:"average_volume_60d_calc",operation:"greater",right:1e5},{left:"change",operation:"greater",right:3},{left:"relative_volume_10d_calc",operation:"greater",right:3},{left:"market_cap_basic",operation:"egreater",right:8e9}],ignore_unknown_fields:!1,options:{lang:"en"},range:[0,100],sort:{sortBy:"market_cap_basic",sortOrder:"desc"},symbols:{},markets:["india"],filter2:{operator:"and",operands:[{operation:{operator:"or",operands:[{operation:{operator:"and",operands:[{expression:{left:"type",operation:"equal",right:"stock"}},{expression:{left:"typespecs",operation:"has",right:["common"]}}]}}]}},{operation:{operator:"or",operands:[{operation:{operator:"and",operands:[{expression:{left:"type",operation:"equal",right:"stock"}},{expression:{left:"typespecs",operation:"has",right:["common"]}}]}},{operation:{operator:"and",operands:[{expression:{left:"type",operation:"equal",right:"stock"}},{expression:{left:"typespecs",operation:"has",right:["preferred"]}}]}},{operation:{operator:"and",operands:[{expression:{left:"type",operation:"equal",right:"dr"}}]}},{operation:{operator:"and",operands:[{expression:{left:"type",operation:"equal",right:"fund"}},{expression:{left:"typespecs",operation:"has_none_of",right:["etf"]}}]}}]}}]}},"1-month-high":{columns:["name","description","close","change","volume","relative_volume","SMA20","market_cap_basic","sector"],filter:[{left:"country",operation:"in_range",right:["India"]},{left:"exchange",operation:"in_range",right:["NSE"]},{left:"close",operation:"egreater",right:30},{left:"average_volume_60d_calc",operation:"greater",right:1e5},{left:"High.1M",operation:"eless",right:"high"},{left:"market_cap_basic",operation:"egreater",right:8e9}],ignore_unknown_fields:!1,options:{lang:"en"},range:[0,100],sort:{sortBy:"market_cap_basic",sortOrder:"desc"},symbols:{},markets:["india"],filter2:{operator:"and",operands:[{operation:{operator:"or",operands:[{operation:{operator:"and",operands:[{expression:{left:"type",operation:"equal",right:"stock"}},{expression:{left:"typespecs",operation:"has",right:["common"]}}]}}]}},{operation:{operator:"or",operands:[{operation:{operator:"and",operands:[{expression:{left:"type",operation:"equal",right:"stock"}},{expression:{left:"typespecs",operation:"has",right:["common"]}}]}},{operation:{operator:"and",operands:[{expression:{left:"type",operation:"equal",right:"stock"}},{expression:{left:"typespecs",operation:"has",right:["preferred"]}}]}},{operation:{operator:"and",operands:[{expression:{left:"type",operation:"equal",right:"dr"}}]}},{operation:{operator:"and",operands:[{expression:{left:"type",operation:"equal",right:"fund"}},{expression:{left:"typespecs",operation:"has_none_of",right:["etf"]}}]}}]}}]}},"100-percent-up":{columns:["name","description","close","change","volume","relative_volume","SMA20","market_cap_basic","sector"],filter:[{left:"country",operation:"in_range",right:["India"]},{left:"exchange",operation:"in_range",right:["NSE"]},{left:"close",operation:"egreater",right:30},{left:"average_volume_60d_calc",operation:"greater",right:1e5},{left:"market_cap_basic",operation:"egreater",right:8e9},{left:"Perf.Y",operation:"greater",right:100}],ignore_unknown_fields:!1,options:{lang:"en"},range:[0,100],sort:{sortBy:"market_cap_basic",sortOrder:"desc"},symbols:{},markets:["india"],filter2:{operator:"and",operands:[{operation:{operator:"or",operands:[{operation:{operator:"and",operands:[{expression:{left:"type",operation:"equal",right:"stock"}},{expression:{left:"typespecs",operation:"has",right:["common"]}}]}}]}},{operation:{operator:"or",operands:[{operation:{operator:"and",operands:[{expression:{left:"type",operation:"equal",right:"stock"}},{expression:{left:"typespecs",operation:"has",right:["common"]}}]}},{operation:{operator:"and",operands:[{expression:{left:"type",operation:"equal",right:"stock"}},{expression:{left:"typespecs",operation:"has",right:["preferred"]}}]}},{operation:{operator:"and",operands:[{expression:{left:"type",operation:"equal",right:"dr"}}]}},{operation:{operator:"and",operands:[{expression:{left:"type",operation:"equal",right:"fund"}},{expression:{left:"typespecs",operation:"has_none_of",right:["etf"]}}]}}]}}]}}},o=t[e]||"volume-buzzers";return console.log("Original criteria:",e,"Mapped to:",o),r[o]||r["volume-buzzers"]})(o),a=await fetch("https://scanner.tradingview.com/india/scan",{method:"POST",headers:{"Content-Type":"application/json","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"},body:JSON.stringify(e)});if(!a.ok)throw Error(`HTTP error! status: ${a.status}`);let n=a.headers.get("content-type");if(!n||!n.includes("application/json")){let e=await a.text();throw console.error("Non-JSON response:",e),Error("Invalid response format, expected JSON")}let i=await a.json(),s=[];i&&i.data&&(s=i.data.map((e,r)=>{let o=e.d||[];return{symbol:o[0]||"N/A",description:o[1]||"",price:o[2]||0,change:o[3]||0,volume:o[4]||0,rvol:o[5]?parseFloat(o[5]).toFixed(2):"-",sma20:o[6]?parseFloat(o[6]).toFixed(2):"-",marketCap:o[7]||0,sector:o[8]||"Finance",smaDistance:o[6]&&o[2]?(o[2]-o[6])/o[6]*100:0}})),r.status(200).json({success:!0,data:s,count:s.length,criteria:o,timestamp:new Date().toISOString()})}catch(e){console.error("Error fetching stocks:",e),r.status(500).json({success:!1,message:e.message||"Failed to fetch stock data",data:[],count:0})}}let p=(0,i.M)(t,"default"),l=(0,i.M)(t,"config"),c=new a.PagesAPIRouteModule({definition:{kind:n.A.PAGES_API,page:"/api/stocks/screener",pathname:"/api/stocks/screener",bundlePath:"",filename:""},userland:t})}};var r=require("../../../webpack-api-runtime.js");r.C(e);var o=r(r.s=9914);module.exports=o})();